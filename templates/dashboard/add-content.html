{% extends 'dashboard-base.html' %}
{% block title %}Edit User{% endblock %}
{% block content %}
<main>
    <script src="https://cdn.ckeditor.com/ckeditor5/12.0.0/classic/ckeditor.js"></script>  
    <div class="user_details_sec edit_service" bis_skin_checked="1">
    
        <div class="top_main_heading services_sec_top" bis_skin_checked="1">
            <div class="heading_breadcrumbs" bis_skin_checked="1">
                <h1>Add Content</h1>
                <nav aria-label="Breadcrumb">
                    <ul class="breadcrumb">
                    <li><a href="/dashboard/">Dashboard</a></li>
                    <li><a href="/current-page">Content</a></li>
                    </ul>
                </nav>
            </div>
            <div class="top_add_services" bis_skin_checked="1">
                <a class="cancel_edit_btn btn btn-secondary" href="/dashboard/content-list">Back to List</a>
            </div>
        </div>
    
       
        <form method="POST" action="{% url 'add_content' %}" enctype="multipart/form-data">
            {% csrf_token %}
           <div class="form-group">
    <label for="id_name">Select Page</label>
    <select name="Select_Page" id="Select_Page_id">
        <option value="">--Select a Page--</option>
        <!-- Page options will be populated dynamically -->
    </select>
</div>

<div class="form-group">
    <label for="id_name">Select Section</label>
    <select name="select_section" id="select_section_id">
        <option value="">--Select a Section--</option>
        <!-- Section options will be populated based on selected page -->
    </select>
</div>

            <div class="form-group description-custome" bis_skin_checked="1">
                <label for="id_name">content heading</label>
                <input type="text" name="content_heading" id="id_content_heading" value="" class="form-control">

            </div>
            <div class="form-group description-custome" bis_skin_checked="1">
                <label for="id_name">Content description</label>
                <textarea name="content" id="editor">
                    &lt;p&gt;This is some sample content.&lt;/p&gt;
                </textarea>
                <script>
                    ClassicEditor
                        .create( document.querySelector( '#editor' ) )
                        .catch( error => {
                            console.error( error );
                        } );
                </script>
            </div>
            <div class="form-group description-custome" bis_skin_checked="1">
                <label for="id_name">content image</label>
                <input type="file" id="myfile" name="myfile">

            </div>

            <div class="form-group description-custome" bis_skin_checked="1">
                <label for="id_name">content button</label>
                <input type="text" name="content_button" id="id_content_button" value="" class="form-control">

            </div>




            <button type="submit" class="btn btn-primary">Save</button>

        </form>
    </div>

            </main>


 <script>

        const jsonData = {{ jsonData|safe }};


        const pages = jsonData.pages;
        const sections = jsonData.sections;


        const selectPageElement = document.getElementById("Select_Page_id");
        pages.forEach(page => {
            let option = document.createElement("option");
            option.value = page.id;
            option.textContent = page.pageName;
            selectPageElement.appendChild(option);
        });


        selectPageElement.addEventListener('change', function() {
            const selectedPageId = parseInt(selectPageElement.value);
            const selectSectionElement = document.getElementById("select_section_id");


            selectSectionElement.innerHTML = '<option value="">--Select a Section--</option>';

            if (selectedPageId) {

                const filteredSections = sections.filter(section => section.pageName_id === selectedPageId);


                filteredSections.forEach(section => {
                    let option = document.createElement("option");
                    option.value = section.id;
                    option.textContent = section.sectionName;
                    selectSectionElement.appendChild(option);
                });
            }
        });
    </script>


{% endblock %}