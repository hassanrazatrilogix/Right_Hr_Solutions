{% extends 'dashboard-base.html' %}
{% block title %}Edit Content{% endblock %}
{% block content %}
<style>
    #subcontent-container{
     width:100%
    }
.subcontent-entry{
 .form-group {
    max-width:100% !important;
    }
    textarea {
    width:100% !important;
    margin-bottom:10px !important;
    }
    .des-title{
    padding-top:26px !important;
    }
    }
    .buttons{
    padding-top:40px;
     transform:translateX(23%);
    }



</style>
<main>
    <script src="https://cdn.ckeditor.com/ckeditor5/12.0.0/classic/ckeditor.js"></script>
    <div class="user_details_sec edit_service">

        <div class="top_main_heading services_sec_top">
            <div class="heading_breadcrumbs">
                <h1>Edit Content</h1>
                <nav aria-label="Breadcrumb">
                    <ul class="breadcrumb">
                        <li><a href="/dashboard/">Dashboard</a></li>
                        <li><a href="/current-page">Content</a></li>
                    </ul>
                </nav>
            </div>
            <div class="top_add_services">
                <a class="cancel_edit_btn btn btn-secondary" href="/dashboard/content-list">Back to List</a>
            </div>
        </div>

        <form method="POST" action="{% url 'edit-content' content_id=content_to_update.id %}" enctype="multipart/form-data">
            {% csrf_token %}

            <!-- Select Content Page -->
            <div class="form-group">
                <label for="Select_Page_id">Select Page</label>
                <select name="Select_Page" id="Select_Page_id">
                    <option value="">--Select a Page--</option>
                    {% for page in pages %}
                        <option value="{{ page.id }}">{{ page.pageName }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Select Section -->
            <div class="form-group">
                <label for="select_section_id">Select Section</label>
                <select name="select_section" id="select_section_id">
                    <option value="">--Select a Section--</option>
                    {% for section in sections %}
                        <option value="{{ section.id }}">{{ section.sectionName }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Content Heading -->
            <div class="form-group description-custome">
                <label for="id_content_heading">Content Heading</label>
                <input type="text" name="content_heading" id="id_content_heading" value="{{content_to_update.contentHeading}}" class="form-control">
            </div>

            <!-- Content Description -->
            <div class="form-group description-custome">
                <label for="id_content">Content Description</label>
                <textarea name="content" id="editor">&lt;p&gt;{{content_to_update.contentDescription|safe }}&lt;/p&gt;</textarea>
                <script>
                    ClassicEditor.create(document.querySelector('#editor')).catch(error => { console.error(error); });
                </script>
            </div>

            <!-- Content Image -->
            <div class="form-group description-custome">
                <label for="myfile">Content Image</label>
                <input type="file" name="myfile" id="myfile" value="{{content_to_update.contentImage.url }}" class="form-control">
            </div>

            <!-- Content Button -->
            <div class="form-group description-custome">
                <label for="id_content_button">Content Button</label>
                <input type="text" name="content_button" id="id_content_button" value="{{content_to_update.contentButton }}" class="form-control">
            </div>

            <!-- Sub-Content (Dynamic) -->
            <div id="subcontent-container">
                <div class="subcontent-entry">
                    <div class="form-group">
                        <label for="subheading_name">Subheading Name</label>
                        <input type="text" name="subheading_name" class="form-control" value="{{content_to_update.sub_contentHeading }}">
                    </div>

                    <div class="form-group">
                        <label for="subheading_description" class="des-title">Subheading Description</label>
                        <textarea name="subheading_description" class="form-control" rows="8">{{content_to_update.subContent }}</textarea>
                    </div>

                    <div class="form-group subhead">
                        <label for="subheading_image">Subheading Image</label>
                        <input type="file" name="subheading_image" class="form-control" value="{{content_to_update.subContentImage }}">
                    </div>
                    </div>
                    <div class="buttons">
                        <!-- Add More Sub-Content Button -->
                        <button type="button" id="add-subcontent" class="btn btn-secondary border-red-1px" >Add More Sub-Content</button>
                        <!-- Submit Button -->
                        <button type="submit" class="btn btn-primary">Save</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</main>

<script>
    document.getElementById('add-subcontent').addEventListener('click', function() {
        // Clone the first subcontent entry and append it to the container
        let subcontentContainer = document.querySelector(".subcontent-entry");
        let newSubcontent = subcontentContainer.cloneNode(true);
        let mainSubSequentContainer =  document.querySelector("#subcontent-container")
        let lastChild   =  mainSubSequentContainer.querySelector(".buttons")
        lastChild.parentNode.insertBefore(newSubcontent,lastChild)
    });


</script>
{% endblock %}
